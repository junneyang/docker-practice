<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" style="height: 100%;border: none;padding: 0px;margin: 0px;">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
	<meta http-equiv="X-UA-Compatible" content="IE=10; IE=9; IE=8; IE=7;  IE=EDGE"/>
	<meta content="Job Center" name="keywords" />
	<meta content="Job Center" name="description" />
	<meta name="generator" content="Job Center"/>
	<title>Job Center-Malakas</title>
	<link rel="stylesheet" href="/static/js/model/bootstrap-3.3.1-dist/dist/css/bootstrap.min.css" type="text/css"/>
	<link rel="stylesheet" href="/static/js/model/bootstrap-3.3.1-dist/dist/css/bootstrap-theme.min.css" type="text/css"/>
	<!--<link rel="stylesheet" href="/static/js/model/DataTables-1.10.4-trial/media/css/jquery.dataTables.css" type="text/css"/>
	<link rel="stylesheet" href="/static/js/model/DataTables-1.10.4-trial/extensions/TableTools/css/dataTables.tableTools.min.css" type="text/css"/>
	<link rel="stylesheet" href="/static/js/model/DataTables-1.10.4-trial/extensions/Editor-1.3.3/css/dataTables.editor.min.css" type="text/css"/>
	<link rel="stylesheet" href="/static/js/model/bootstrap-3.3.1-dist/dist/css/font-awesome.css" type="text/css"/>
	<link rel="stylesheet" href="/static/css/demo/nav/docs.min.css" type="text/css"/>-->
	<link rel="stylesheet" href="/static/js/model/bootstrap-datetimepicker-master/build/css/bootstrap-datetimepicker.min.css" type="text/css"/>
	<link rel="stylesheet" href="/static/js/model/bootstrap-table-master/dist/bootstrap-table.min.css" type="text/css"/>
	<style type="text/css">
		/* Move down content because we have a fixed navbar that is 50px tall */
		body {
			padding-top: 50px;
			padding-bottom: 20px;
		}
		
		/* item img opacity */
		.item img {
			opacity:0.8;
			filter:alpha(opacity=80); /* 针对 IE8 以及更早的版本 */
		}
		
		/* footer css #f8f8f8; */
		.pb-page-footer{
			width: 100%;
			color: gray;
			background-color: #3C3C3C;
			#border-top: 1px solid #e7e7e7;
			margin-top: 5px;
			margin-bottom: 0px;
			padding-top: 30px;
			padding-bottom: 30px;
		}
		.pb-page-footer a, .pb-page-footer a:visited {
			color: #777;
			text-decoration: none;
		}
		.pb-page-footer a:active, .pb-page-footer a:hover, .pb-page-footer a:focus{
			color: white;
			text-decoration: none;
		}
		body {
			padding-bottom:0px;
		}
		.pb-page-footer h4 {
			color:white;
		}
		
		/* job center body */
		.form-control {
			height: 34px;
		}
		.keep-open {
			height: 28px;
		}
		div.bootstrap-table > div.fixed-table-toolbar > div.columns.columns-right.btn-group.pull-right > div > button {
			height: 28px;
		}
		div.fixed-table-pagination > div.pull-left.pagination-detail > span.page-list {
			display: inline-block !important;
		}
		div.fixed-table-container > div.fixed-table-pagination > div.pull-right.pagination {
			display: inline-block !important;
		}
		.fixed-table-container {
			border: none;
		}
		
		.stepwizard-step p {
			margin-top: 10px;
		}

		.stepwizard-row {
			display: table-row;
		}

		.stepwizard {
			display: table;
			width: 100%;
			position: relative;
		}

		.stepwizard-step button[disabled] {
			opacity: 1 !important;
			filter: alpha(opacity=100) !important;
		}

		.stepwizard-row:before {
			top: 14px;
			bottom: 0;
			position: absolute;
			content: " ";
			width: 100%;
			height: 1px;
			background-color: #ccc;
			z-order: 0;

		}

		.stepwizard-step {
			display: table-cell;
			text-align: center;
			position: relative;
		}

		.btn-circle {
		  width: 30px;
		  height: 30px;
		  text-align: center;
		  padding: 6px 0;
		  font-size: 12px;
		  line-height: 1.428571429;
		  border-radius: 15px;
		}

	</style>
</head>
<body>
	<!-- Navigation
	================================================== -->
	<nav class="navbar navbar-fixed-top navbar-inverse">
		<div class="container">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="/" style="font-size:18px;font-weight:bold;color:#FFF;"><!--<img alt="Brand" src="/static/images/favicon.ico" title="junneyang.sinaapp.com" style="margin-left:5px;height:24px;width:24px;"/>-->Malakas</a>
			</div>
			<div id="navbar" class="collapse navbar-collapse js-navbar-collapse">
				<ul class="nav navbar-nav">
					<li><a href="/">Home</a></li>
					<li><a href="#">Dashboard</a></li>
					<li  class="active"><a href="/jobcenter/">Job Center</a></li>
					<li><a href="/deploy/">Deploy</a></li>
					<!--<li class="dropdown dropdown-large">
						<a href="#" class="dropdown-toggle" data-toggle="dropdown">Blog Center<span class="caret"></span></a>
						<ul class="dropdown-menu dropdown-menu-large row">
							<li class="col-sm-4">
								<ul>
									<li class="dropdown-header">系统</li>
									<li><a href="#">Linux</a></li>
									<li><a href="#">Shell</a></li>
									<li class="divider"></li>
									<li class="dropdown-header">架构</li>
									<li><a href="#">设计模式</a></li>
									<li><a href="#">Web系统</a></li>
									<li><a href="#">后端</a></li>
									<li><a href="#">网络框架</a></li>
									<li><a href="#">中间件</a></li>
								</ul>
							</li>
							<li class="col-sm-4">
								<ul>
									<li class="dropdown-header">开发</li>
									<li><a href="#">C/C++</a></li>
									<li><a href="#">Java</a></li>
									<li><a href="#">Python</a></li>
									<li><a href="#">html/css/js</a></li>
									<li><a href="#">Algorithm</a></li>
									<li class="divider"></li>
									<li class="dropdown-header">测试</li>
									<li><a href="#">系统测试</a></li>
									<li><a href="#">自动化测试</a></li>
									<li><a href="#">性能测试</a></li>
									<li><a href="#">持续集成</a></li>
								</ul>
							</li>
							<li class="col-sm-4">
								<ul>
									<li class="dropdown-header">云计算</li>
									<li><a href="#">数据中心</a></li>
									<li><a href="#">虚拟化</a></li>
									<li><a href="#">OpenStack</a></li>
									<li><a href="#">Hadoop/Spark</a></li>
									<li><a href="#">SDN/NFV</a></li>
									<li><a href="#">存储技术</a></li>
								</ul>
							</li>
						</ul>
					</li>-->
					<li><a href="/help/">Help</a></li>
				</ul>
				<!--<form class="navbar-form navbar-right" role="search">
					<div class="form-group"><input type="text" class="form-control" placeholder="Search"></div>
					<button type="submit" class="btn btn-default">Submit</button>
				</form>-->
				<ul class="nav navbar-nav navbar-right">
					<li><a href="#" class="navbar-link">sign up</a></li>
					<li class="dropdown">
						<a href="#" class="navbar-link" class="dropdown-toggle" data-toggle="dropdown">log in<b class="caret"></b></a>
						<ul class="dropdown-menu" style="padding:15px;min-width:250px;">
							<li>
								<div class="row">
									<div class="col-md-12">
										<form class="form" role="form" onsubmit="return loginWithDefault();">
											<div class="form-group">
												<label class="sr-only" for="exampleInputEmail2">Email address</label>
												<input type="email" class="form-control" id="exampleInputEmail2" placeholder="Email address" required>
											</div>
											<div class="form-group">
												<label class="sr-only" for="exampleInputPassword2">Password</label>
												<input type="password" class="form-control" id="exampleInputPassword2" placeholder="Password" required>
											</div>
											<div class="checkbox">
												<label>
												<input type="checkbox" class="checkbox" checked="checked"/>Subscribe Newsletter
												</label>
											</div>
											<div class="form-group">
												<button type="submit" class="btn btn-success btn-block">Sign in</button>
											</div>
										</form>
									</div>
								</div>
							</li>
							<li class="divider"></li>
							<li>
								<input class="btn btn-primary btn-block" type="button" id="sign-in-google" value="Sign In with QQ">
								<input class="btn btn-primary btn-block" type="button" id="sign-in-twitter" value="Sign In with GitHub">
								<!--<input class="btn btn-primary btn-block" type="button" id="sign-in-google" value="Sign In with Google">-->
							</li>
						</ul>
					</li>
				</ul>
				<!--<ul class="nav navbar-nav navbar-right">
					<li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">{{usrname}}<span class="caret"></span></a>
						<ul class="dropdown-menu" role="menu">
							<li><a href="#">个人中心</a></li>
							<li><a href="#">退出登录</a></li>
						</ul>
					</li>
					<li class="divider-vertical"></li>
					<li><a href="#">帮助</a></li>
				</ul>-->
			</div><!-- /.nav-collapse -->
		</div><!-- /.container -->
	</nav><!-- /.navbar -->	
	<!--<div class="container-fluid">
		<div class="notice">
			<div class="col-sm-6">
				<ul>
					<li>Home</li>
					<li>Products</li>
					<li>About Us</li>
					<li>Contact</li>
				</ul>
			</div>
			<div class="col-sm-6">
				<ul class="list-unstyled">
					<li>Home</li>
					<li>Products</li>
					<li>About Us</li>
					<li>Contact</li>
				</ul>
			</div>
		</div>
	</div>-->
	<div class="container-fluid" style='min-height:720px;'>
		<div class="container" style="margin-top:50px;">
			<h4 class="page-header" style="margin-top:10px;">New Job -- Basic</h4>
			<div class="stepwizard">
				<div class="stepwizard-row setup-panel">
					<div class="stepwizard-step">
						<a href="#step-1" type="button" class="btn btn-primary btn-circle">1</a>
						<p>Step 1</p>
					</div>
					<div class="stepwizard-step">
						<a href="#step-2" type="button" class="btn btn-default btn-circle" disabled="disabled">2</a>
						<p>Step 2</p>
					</div>
					<div class="stepwizard-step">
						<a href="#step-3" type="button" class="btn btn-default btn-circle" disabled="disabled">3</a>
						<p>Step 3</p>
					</div>
				</div>
			</div>
			<form role="form">
				<div class="row setup-content" id="step-1">
					<div class="col-xs-12">
						<div class="col-md-12">
							<h3> Step 1</h3>
							<div class="form-group">
								<label class="control-label">* JobType</label>&nbsp;&nbsp;<a href="/help/#id_createjob_basic" style="vertical-align: middle;">Help ?</a>
								<input  maxlength="100" type="text" required="required" class="form-control" placeholder="Basic" value="Basic" disabled>
							</div>
							<div class="form-group">
								<label class="control-label">* JobName</label>&nbsp;&nbsp;<a href="/help/#id_createjob_basic" style="vertical-align: middle;">Help ?</a>
								<input id="id_job_name" maxlength="100" type="text" required="required" class="form-control" placeholder="Enter Job Name, eg: JobName" />
							</div>
					
							<button class="btn btn-primary nextBtn pull-right" type="button" style="margin-left:10px">Next</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
							<button class="btn btn-primary nextBtn pull-right" type="button" onclick="javascript:window.location.href='/jobcenter/'">Cancel</button>
						</div>
					</div>
				</div>
				<div class="row setup-content" id="step-2">
					<div class="col-xs-12">
						<div class="col-md-12">
							<h3> Step 2</h3>
							<div class="form-group">
								<label class="control-label">* ModuleName</label>&nbsp;&nbsp;<a href="/help/#id_createjob_basic" style="vertical-align: middle;">Help ?</a>
								<input id="id_module_name" maxlength="200" type="text" required="required" class="form-control" placeholder="Enter Module Name, eg: shell" />
							</div>
							<div class="form-group">
								<label class="control-label">ModuleArgs</label>&nbsp;&nbsp;<a href="/help/#id_createjob_basic" style="vertical-align: middle;">Help ?</a>
								<input id="id_module_args" maxlength="200" type="text" class="form-control" placeholder="Enter Module Args, eg: sleep 5 && date && echo $PATH"  />
							</div>
							<div class="form-group">
								<label class="control-label">* HostList</label>&nbsp;&nbsp;<a href="/help/#id_createjob_basic" style="vertical-align: middle;">Help ?</a>
								<input id="id_pattern" maxlength="200" type="text" required="required" class="form-control" placeholder="Enter Host List, eg: 10.20.0.89;10.20.0.90"  />
							</div>
							<div class="form-group">
								<label class="control-label">Forks</label>&nbsp;&nbsp;<a href="/help/#id_createjob_basic" style="vertical-align: middle;">Help ?</a>
								<input id="id_forks" maxlength="200" type="text" class="form-control" placeholder="Enter Forks Number, eg: 5"  />
							</div>
							<div class="form-group">
								<label class="control-label">Submit</label>&nbsp;&nbsp;<a href="/help/#id_createjob_basic" style="vertical-align: middle;">Help ?</a>
								<input id="id_job_submit" maxlength="200" type="text" class="form-control" placeholder="Enter Submit User, eg: yangjun"  />
							</div>
							
							<button class="btn btn-primary nextBtn pull-right" type="button" style="margin-left:10px">Next</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
							<button class="btn btn-primary nextBtn pull-right" type="button" onclick="javascript:window.location.href='/jobcenter/'">Cancel</button>
						</div>
					</div>
				</div>
				<div class="row setup-content" id="step-3">
					<div class="col-xs-12">
						<div class="col-md-12">
							<h3> Step 3</h3>
							
							<button class="btn btn-success pull-right" type="submit" style="margin-left:10px" onclick="return submitJobBasic();">Submit!</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
							<button class="btn btn-primary nextBtn pull-right" type="button" onclick="javascript:window.location.href='/jobcenter/'">Cancel</button>
							<div id="id_loading" style="display:none;">
								<p style="text-align:center;"><img src="/static/images/loading.gif"></img></p>
								<p style="text-align:center;">Submitting，Please wait a moment...</p>
							</div>
						</div>
					</div>
				</div>
			</form>
		</div>
	</div>
	
	<footer class="footer" style="margin-top:0px;margin-bottom:0px;padding-top:20px;background-color:black;">
		<div class="container text-center">
			<p class="text-muted">Copyright ©2015 NSFOCUS. All Rights Reserved. </p>
			<p class="text-muted">Technical Support : <a href="http://www.ansible.com/">Ansible</a></p>
			<p class="text-muted">Malakas 2015 Lab @NSFOCUS</p><br/>
		</div>
	</footer>
	
	
	<!-- Modal -->
	<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<!--<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>-->
					<h4 class="modal-title" id="myModalLabel">Info</h4>
				</div>
				<div class="modal-body text-center">
					Operation Success
				</div>
				<!--<div class="modal-footer">
					<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
					<button type="button" class="btn btn-primary">Save changes</button>
				</div>-->
			</div>
		</div>
	</div>
	<!-- Alert -->
	<div id="alerts" style='position:fixed;top:60px;right:20px;'></div>
	
	<script src="/static/js/jquery-1.11.2.min.js"></script>
	<script src="/static/js/model/bootstrap-3.3.1-dist/dist/js/bootstrap.min.js"></script>
	<!--<script src="/static/js/model/bootstrap-treeview-master/bootstrap-treeview-master/dist/bootstrap-treeview.min.js"></script>-->
	<script src="/static/js/model/Highcharts-4.0.4/js/highcharts.js"></script>
	<!--<script src="/static/js/model/DataTables-1.10.4-trial/media/js/jquery.dataTables.min.js"></script>
	<script src="/static/js/model/DataTables-1.10.4-trial/extensions/TableTools/js/dataTables.tableTools.min.js"></script>
	<script src="/static/js/model/DataTables-1.10.4-trial/extensions/Editor-1.3.3/js/dataTables.editor.min.js"></script>
	<script src="/static/js/model/jquery-validation-1.13.1/dist/jquery.validate.min.js"></script>-->
	<script src="/static/js/model/bootstrap-3.3.1-dist/dist/js/docs.min.js"></script>
	<script src="/static/js/model/moment-develop/min/moment-with-locales.min.js"></script>
	<script src="/static/js/model/bootstrap-datetimepicker-master/build/js/bootstrap-datetimepicker.min.js"></script>
	<script src="/static/js/model/bootstrap-table-master/dist/bootstrap-table.min.js"></script>
	<script src="/static/js/model/bootstrap-table-master/dist/locale/bootstrap-table-zh-CN.min.js"></script>
	<script type="text/javascript">
		/**********************************************************************************************
		*****账号下拉列表初始化
		**********************************************************************************************/
		//表格行style设置
		function rowStyle(row, index) {
			var classes = ['active', 'success', 'info', 'warning', 'danger'];
			/*if (index % 2 === 0 && index / 2 < classes.length) {
				return {
					classes: classes[index / 2]
				};
			}*/
			/*if (row.job_status == 5) {
				return {
					classes: 'danger'
				};
			}*/
			return {};
		}
		//表格列data设置
		function operationFormatter(value) {
			//return '<a href="#"><i class="glyphicon glyphicon-cutlery"></i>查看</a> <a href="#"><i class="glyphicon glyphicon-cutlery"></i>修改</a>';
			//return '<i class="glyphicon glyphicon-cutlery"></i> ' ;//+ value;
			//return '<a href="javascript:relateURL(' + value + ')"><i class="glyphicon glyphicon-search"></i>查看</a>';
			if (value.job_type == 0 || value.job_type == 1) {
				return "<a href='/getJobStatusByID/?job_id="+value.id+"'>执行结果</a>";
			} else if (value.job_type == 2 && value.job_status < 4) {
				return "<a href='/getJobStatusByID/?job_id="+value.id+"'>执行结果</a>";
			} else if (value.job_type == 2 && value.job_status >= 4) {
				return "<a href='/getJobStatusByID/?job_id="+value.id+"'>执行结果</a> | " +
				"<a href='/getPlaybookJobLog/?job_id="+value.id+"'>详细日志</a>";
			}
		}
		function jobTypeFormatter(value) {
			if (value == 0) {
				return "Basic";
			} else if (value == 1) {
				return "Script";
			} else if (value == 2) {
				return "Playbook";
			}
		}
		function jobStatusFormatter(value) {
			if (value == 0) {
				return "<img src='/static/images/r_loading.gif' title='initial'>";
			} else if (value == 1) {
				return "<img src='/static/images/r_running.gif' title='submited'>";
			} else if (value == 2) {
				return "<img src='/static/images/r_running.gif' title='scrabed'>";
			} else if (value == 3) {
				return "<img src='/static/images/r_running.gif' title='polled'>";
			} else if (value == 4) {
				return "<img src='/static/images/r_running.gif' title='running'>";
			} else if (value == 5) {
				return "<img src='/static/images/r_exception.png' title='exception'>";
			} else if (value == 6) {
				return "<img src='/static/images/r_success.png' title='success'>";
			}
		}
		//表格index设置
		function runningFormatter(value, row, index) {
			return index;
		}
		//表格复选设置
		function stateFormatter(value, row, index) {
			if (index === 2) {
				return {
					disabled: true
				};
			}
			if (index === 0) {
				return {
					disabled: true,
					checked: true
				}
			}
			return value;
		}
		//表格分页查询设置
		function queryParams() {
			return {
				limit: 5,
				offset: 0,
				//search: 
				sort: 'id',
				order: 'desc'
			};
		}
		/*
		$(document).ready(function() {
			$('.page-list').css('display','inline-block'); 
			$('.pagination').css('display','inline-block'); 
			$('.page-list').css({visibility,"visible"});
			$('.pagination').css({visibility,"visible"});
		});*/
		/*$(document).ready(function() {
			$('#datetimepicker1').datetimepicker({
				format: 'YYYY-MM-DD',
				useCurrent: true,
				calendarWeeks: true,
				showTodayButton: true,
				showClear: true
			});
		});
		$(document).ready(function() {
			initAccountList();
		});*/
		function initAccountList() {
			$.when(queryAccounts()).done(function(data){
				$.each(data,function(n,value) {  
					$("#id_account_select").append('<option value="' + value + '">' + value + '</option>');
				});
			});
		}
		function queryAccounts() {
			var metricsID = parseRequestURL("metricsID");
			//alert(metricsID);
			var defer = $.Deferred();
			$.ajax({
				type: "POST",
				url : '/queryAccounts/',
				contentType: "application/json; charset=utf-8",
				dataType: "json",
				data: {metricsID:metricsID},
				//async : false,
				success: function(data){
					defer.resolve(data)
				}
			});
			return defer.promise();
		}
		/**********************************************************************************************
		*****账户点击率监控曲线
		**********************************************************************************************/
		function queryAccountInfoChart() {
			var date = $("#datetimepicker1 input").val();
			alert(date);
			var account = $("#id_account_select option:selected").val();
			if(account == "NULL") {
				alert("请选择查询账号");
				return;
			}
			var categories = new Array();
			var data = new Array();
			data[0] = new Array();
			data[1] = new Array();
			data[2] = new Array();
			data[3] = new Array();
			$.each(accountInfo,function(i,item) {
				$.each(item,function(j,itemitem) {  
					if(itemitem.accountName == account) {
						categories.push(itemitem.datetime);
						data[0].push(Number(itemitem.clickrate[0]));
						data[1].push(Number(itemitem.clickrate[1]));
						data[2].push(Number(itemitem.clickrate[2]));
						data[3].push(Number(itemitem.clickrate[3]));
					}
				});
			});
			/*alert(data[0]);
			alert(data[1]);
			alert(data[2]);
			alert(data[3]);*/
			disStatChart(categories, data);
		}
		/*$(document).ready(function() {
			initAlarmTrendChart();
		});
		function initAlarmTrendChart(){
			$('#alarmTrendLoading').show();
			$.when(queryAlarmTrendData()).done(function(data){
				$('#alarmTrendLoading').hide();
				disAlarmTrendChart(data.date, data.data);
			});
		}
		function queryAlarmTrendData() {
			var defer = $.Deferred();
			$.ajax({
				type: "POST",
				url : '/queryAlarmDayperiod/',
				contentType: "application/json; charset=utf-8",
				dataType: "json",
				//async : false,
				success: function(data){
					defer.resolve(data)
				}
			});
			return defer.promise();
		}*/
		function disStatChart(categories, data) {
			$('#container_account_clickrate').highcharts({
				chart: {
					type: 'column'
				},
				title: {
					text: '账户点击率监控曲线'
				},
				subtitle: {
					text: '今天-前一周-前两周-前三周'
				},
				credits: { 
					enabled: false   //右下角不显示LOGO 
				}, 
				xAxis: {
					categories: categories
				},
				yAxis: {
					min: 0,
					title: {
						text: '次数/次'
					}
				},
				tooltip: {
					pointFormat: '<b>{series.name} : {point.y}</b>次 ',
					shared: true,
					useHTML: true
				},
				exporting: {
					enabled: true  //设置导出按钮不可用
				},
				plotOptions: {
					column: {
						pointPadding: 0.2,
						borderWidth: 0
					}
				},
				series: [{
					name: '今天',
					data: data[0]

				}, {
					name: '前一周',
					data: data[1]

				}, {
					name: '前两周',
					data: data[2]

				}, {
					name: '前三周',
					data: data[3]

				}]
			});
		}
		function parseRequestURL(paras) {
			var url = location.href;
			var paraString = url.substring(url.indexOf("?")+1,url.length).split("&"); 
			var paraObj = {} 
			for (i=0; j=paraString[i]; i++){ 
				paraObj[j.substring(0,j.indexOf("=")).toLowerCase()] = j.substring(j.indexOf("=")+1,j.length); 
			} 
			var returnValue = paraObj[paras.toLowerCase()]; 
			if(typeof(returnValue)=="undefined"){ 
				return ""; 
			}else{ 
				return returnValue; 
			} 
		}
		
		
		//向导插件
		$(document).ready(function () {
			var navListItems = $('div.setup-panel div a'),
					allWells = $('.setup-content'),
					allNextBtn = $('.nextBtn');

			allWells.hide();

			navListItems.click(function (e) {
				e.preventDefault();
				var $target = $($(this).attr('href')),
						$item = $(this);

				if (!$item.hasClass('disabled')) {
					navListItems.removeClass('btn-primary').addClass('btn-default');
					$item.addClass('btn-primary');
					allWells.hide();
					$target.show();
					$target.find('input:eq(0)').focus();
				}
			});

			allNextBtn.click(function(){
				var curStep = $(this).closest(".setup-content"),
					curStepBtn = curStep.attr("id"),
					nextStepWizard = $('div.setup-panel div a[href="#' + curStepBtn + '"]').parent().next().children("a"),
					curInputs = curStep.find("input[type='text'],input[type='url']"),
					isValid = true;

				$(".form-group").removeClass("has-error");
				for(var i=0; i<curInputs.length; i++){
					if (!curInputs[i].validity.valid){
						isValid = false;
						$(curInputs[i]).closest(".form-group").addClass("has-error");
					}
				}

				if (isValid)
					nextStepWizard.removeAttr('disabled').trigger('click');
			});

			$('div.setup-panel div a.btn-primary').trigger('click');
		});
		
		
		function showModal(){
			$('#myModal').modal('show');
		}
		function hideModal(){
			$('#myModal').modal('hide');
		}
		$(document).ready(function(){
			$('#myModal').on('shown.bs.modal', function() {
				// remove previous timeouts if it's opened more than once.
				//clearTimeout(myModalTimeout);
				myModalTimeout = setTimeout(function() {
					hideModal();
				}, 2000);
			});
		});
		function addAlert(message) {
			$('#alerts').append(
				'<div class="alert alert-danger alert-dismissible fade in" style="min-width:300px;">' +
					'<button type="button" class="close" data-dismiss="alert">' +
					'&times;</button>' + message + '</div>');
		}
		function submitJobBasic() {
			var request = {};
			request['job_type'] = 0;
			request['job_name'] = $('#id_job_name').val();
			request['module_name'] = $('#id_module_name').val();
			request['module_args'] = $('#id_module_args').val();
			request['pattern'] = $('#id_pattern').val();
			
			var forks = Number($('#id_forks').val());
			if (isNaN(forks)) {
				addAlert("ParamException: " + "forks should be Number.");
				return false;
			}
			
			if (forks < 0 || forks > 100) {
				addAlert("ParamException: " + "forks should be between 1 and 100.");
				return false;
			}
			
			if (forks == 0) {
				request['forks'] = 5;
			} else {
				request['forks'] = forks;
			}
			
			var submit = $('#id_job_submit').val();
			if (submit == "") {
				request['job_submit'] = "admin";
			} else {
				request['job_submit'] = submit;
			}
			//alert(JSON.stringify(request));
			$.when(submitJob(request)).done(function(data){
				if(data.ERRORCODE == 0) {
					//showModal();
					window.location.href = "/jobcenter/";
				} else {
					//showModal();
					addAlert(data.CH + " : " + data.msg);
				}
			});
			return false;
		}
		function submitJob(request) {
			var defer = $.Deferred();
			$.ajax({
				type: "POST",
				url : '/submitJob/',
				contentType: "application/json; charset=utf-8",
				dataType: "json",
				data: JSON.stringify(request),
				//async : false,
				beforeSend:function(XMLHttpRequest){
				   document.getElementById('id_loading').style.display = "block";
				},
				success: function(data){
					//document.getElementById('id_loading').style.display = "block";
					defer.resolve(data)
				}
			});
			return defer.promise();
		}
	</script>
</body>
</html>
